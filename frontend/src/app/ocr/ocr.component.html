<div class="min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
  <div class="max-w-2xl mx-auto">

    <!-- Header -->
    <header class="mb-10 border-b border-gray-200 pb-5">
      <h1 class="text-3xl font-extrabold text-gray-900 tracking-tight">ğŸ“¸ Ajouter un cours</h1>
      <p class="text-gray-500 mt-1 text-sm">Prends en photo une ou plusieurs pages de ton cours, l'IA s'occupe du reste.</p>
    </header>

    <!-- Zone de dÃ©pÃ´t -->
    <div
      class="relative border-2 border-dashed rounded-2xl p-10 text-center transition-colors cursor-pointer"
      [class.border-indigo-400]="isDragging"
      [class.bg-indigo-50]="isDragging"
      [class.border-gray-300]="!isDragging"
      [class.bg-white]="!isDragging"
      (dragover)="onDragOver($event)"
      (dragleave)="isDragging = false"
      (drop)="onDrop($event)"
      (click)="fileInput.click()">

      <input #fileInput type="file" accept="image/*" multiple class="hidden" (change)="onFileChange($event)" />

      <div class="flex flex-col items-center space-y-3 pointer-events-none">
        <svg class="w-12 h-12 text-indigo-400" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" />
        </svg>
        <p class="text-gray-600 font-medium">Glisse tes images ici ou <span class="text-indigo-600 underline">clique pour choisir</span></p>
        <p class="text-xs text-gray-400">JPG, PNG â€” plusieurs pages acceptÃ©es</p>
      </div>
    </div>

    <!-- Liste des fichiers sÃ©lectionnÃ©s -->
    <ul *ngIf="selectedFiles.length > 0" class="mt-6 space-y-2">
      <li *ngFor="let file of selectedFiles; let i = index"
          class="flex items-center justify-between bg-white border border-gray-200 rounded-xl px-4 py-3 shadow-sm">
        <div class="flex items-center space-x-3">
          <span class="text-lg">ğŸ–¼ï¸</span>
          <div>
            <p class="text-sm font-medium text-gray-800">{{ file.name }}</p>
            <p class="text-xs text-gray-400">{{ (file.size / 1024).toFixed(0) }} Ko â€” Page {{ i + 1 }}</p>
          </div>
        </div>
        <button (click)="removeFile(i)" class="text-gray-400 hover:text-red-500 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
          </svg>
        </button>
      </li>
    </ul>

    <!-- Bouton envoyer -->
    <button
      *ngIf="selectedFiles.length > 0 && !loading && !result"
      (click)="upload()"
      class="mt-6 w-full py-3 px-6 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition shadow">
      Analyser {{ selectedFiles.length > 1 ? 'les ' + selectedFiles.length + ' pages' : "l'image" }}
    </button>

    <!-- Loading -->
    <div *ngIf="loading" class="mt-8 flex flex-col items-center space-y-4">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div>
      <p class="text-gray-500 font-medium animate-pulse">Analyse en cours...</p>
    </div>

    <!-- Erreur -->
    <div *ngIf="error" class="mt-6 bg-red-50 border-l-4 border-red-500 p-4 rounded shadow-sm">
      <p class="text-red-700 font-medium">âš ï¸ {{ error }}</p>
    </div>

    <!-- RÃ©sultat -->
    <div *ngIf="result" class="mt-8 bg-white border border-gray-200 rounded-2xl shadow p-6 space-y-4">
      <div class="flex items-center justify-between">
        <div>
          <span class="text-xs text-gray-400 uppercase tracking-wide">{{ result.matiere }}</span>
          <h2 class="text-xl font-bold text-gray-900">{{ result.nom_cours }}</h2>
          <p class="text-xs text-gray-400 mt-1">EnregistrÃ© : <span class="font-medium text-indigo-600">{{ result.fichier }}</span></p>
        </div>
        <span class="text-4xl">âœ…</span>
      </div>
      <hr class="border-gray-100" />
      <div class="text-sm text-gray-700 leading-relaxed max-h-80 overflow-y-auto" [innerHTML]="result.texte | markdown"></div>
      <button (click)="reset()" class="mt-2 w-full py-2 border border-indigo-300 text-indigo-600 font-medium rounded-xl hover:bg-indigo-50 transition">
        Ajouter un autre cours
      </button>
    </div>

  </div>
</div>
